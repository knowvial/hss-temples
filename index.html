<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>South Indian Temple Tour</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2, h3 {
            color: #8b4513;
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
        }
        .temple-display {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .temple-image {
            width: 100%;
            height: auto;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        .temple-name {
            font-size: 1.5rem;
            color: #8b4513;
            margin-bottom: 10px;
            font-weight: bold;
        }
        .location {
            font-style: italic;
            color: #666;
            margin-bottom: 10px;
        }
        .description {
            line-height: 1.6;
        }
        .key-facts {
            background-color: #f9f5eb;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }
        .controls {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            padding: 15px;
            background: #f0f0f0;
            border-radius: 8px;
        }
        .btn {
            background-color: #8b4513;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
        }
        .btn:hover {
            background-color: #6d370f;
        }
        .btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .login-container {
            max-width: 400px;
            margin: 80px auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            text-align: center;
        }
        .waiting-screen {
            text-align: center;
            padding: 40px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            margin-top: 50px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            margin-bottom: 10px;
        }
        .presenter-bar {
            background-color: #8b4513;
            color: white;
            padding: 10px;
            text-align: center;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .share-section {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            border: 1px solid #ddd;
        }
        .animated-dots::after {
            content: '.';
            animation: dots 1.5s infinite;
        }
        @keyframes dots {
            0% { content: '.'; }
            33% { content: '..'; }
            66% { content: '...'; }
        }
    </style>
</head>
<body>
    <div class="container" id="container">
        <h1>South Indian Temple Tour</h1>
        <div id="content-area">
            <!-- Content will be populated by JavaScript -->
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script>
        // Temple data
        const temples = [
            {
                name: "Meenakshi Amman Temple",
                location: "Madurai, Tamil Nadu",
                image: "/api/placeholder/800/500",
                description: "The Meenakshi Amman Temple is dedicated to goddess Meenakshi (a form of Parvati) and her consort, Sundareshwar (a form of Shiva). This magnificent temple is known for its towering gopurams (gateway towers) adorned with thousands of colorful sculptures.",
                keyFacts: [
                    "Features 14 gateway towers ranging from 45-50 meters in height",
                    "The temple complex covers 45 acres",
                    "Has a sacred tank called the Golden Lotus Tank (Porthamarai Kulam)",
                    "The current structure dates mainly to the 16th-17th centuries"
                ]
            },
            {
                name: "Brihadeeswarar Temple",
                location: "Thanjavur, Tamil Nadu",
                image: "/api/placeholder/800/500",
                description: "Also known as Peruvudaiyar Kovil, this temple is dedicated to Lord Shiva and was built by Raja Raja Chola I in the 11th century. It's a UNESCO World Heritage Site and one of the largest temples in India.",
                keyFacts: [
                    "The main vimana (tower) stands at 216 feet (66 meters) tall",
                    "The temple is built entirely of granite with over 130,000 tons of granite used",
                    "The main lingam is one of the largest in India, standing about 3.7 meters tall",
                    "The temple's shadow never falls on the ground at noon"
                ]
            },
            {
                name: "Virupaksha Temple",
                location: "Hampi, Karnataka",
                image: "/api/placeholder/800/500",
                description: "Dedicated to Lord Virupaksha, a form of Shiva, this is the oldest and principal temple in Hampi. The temple continues to prosper as an important pilgrimage center even after the fall of the Vijayanagara Empire.",
                keyFacts: [
                    "Temple history dates back to the 7th century",
                    "The main gopuram stands 50 meters high",
                    "Features exquisite stone carvings and impressive pillared halls",
                    "Houses the shrine of Pampa, the local river goddess and consort of Virupaksha"
                ]
            },
            {
                name: "Ekambareswarar Temple",
                location: "Kanchipuram, Tamil Nadu",
                image: "/api/placeholder/800/500",
                description: "This temple is dedicated to Shiva as Ekambareswarar (Lord of the Single Mango Tree). It is one of the Pancha Bhoota Stalas representing the element Earth and is known for its 3,500-year-old mango tree.",
                keyFacts: [
                    "Features a 59-meter high gopuram, one of the tallest temple towers in South India",
                    "The temple complex covers 23 acres",
                    "Contains 1,000 lingam sculptures",
                    "The legendary mango tree is said to produce four different types of mangoes"
                ]
            },
            {
                name: "Annamalaiyar Temple",
                location: "Tiruvannamalai, Tamil Nadu",
                image: "/api/placeholder/800/500",
                description: "Dedicated to Lord Shiva, this temple represents the element fire among the Pancha Bhoota Stalas. The temple is associated with the sacred hill Arunachala, which is considered a manifestation of Shiva himself.",
                keyFacts: [
                    "The main gopuram is 217 feet (66 meters) high",
                    "The temple complex spans 25 acres",
                    "During the Karthigai Deepam festival, a huge lamp is lit atop the Arunachala Hill",
                    "The temple has been praised in the Tamil Tevaram hymns by saints Sambandar and Appar"
                ]
            },
            {
                name: "Ramanathaswamy Temple",
                location: "Rameswaram, Tamil Nadu",
                image: "/api/placeholder/800/500",
                description: "This temple is dedicated to Lord Shiva and is significant as one of the twelve Jyotirlinga shrines. According to legend, Lord Rama worshipped Shiva here to cleanse himself of the sin of killing Ravana.",
                keyFacts: [
                    "Features the longest corridor among all Hindu temples, with 1,212 pillars",
                    "Has 22 theerthams (holy water tanks) within the temple complex",
                    "The main shrine houses a lingam that was installed by Lord Rama himself",
                    "The temple's design follows Dravidian architecture with massive walls and gopurams"
                ]
            },
            {
                name: "Padmanabhaswamy Temple",
                location: "Thiruvananthapuram, Kerala",
                image: "/api/placeholder/800/500",
                description: "This temple is dedicated to Lord Vishnu in the form of Padmanabha (one who emerges from the lotus) reclining on the serpent Anantha. The temple gained international attention for its vast treasure discovered in sealed vaults.",
                keyFacts: [
                    "The main deity is a 18-foot-long Vishnu in Anantha Shayanam posture",
                    "The temple is built in a blend of Kerala and Dravidian architectural styles",
                    "It's one of the 108 sacred Vishnu temples or Divya Desams",
                    "The temple was controlled by the royal family of Travancore until recent times"
                ]
            }
        ];

        // Application variables
        let currentTempleIndex = 0;
        let isPresenterMode = false;
        let sessionId = null;
        const PRESENTER_PASSWORD = "temple123";

        // Function to generate a unique session ID
        function generateSessionId() {
            return 'session-' + Math.random().toString(36).substr(2, 9);
        }

        // Function to create a new session
        function createSession() {
            const newSessionId = generateSessionId();
            const sessionData = {
                active: true,
                currentSlide: 0,
                lastUpdated: new Date().getTime()
            };
            localStorage.setItem('temple-session-' + newSessionId, JSON.stringify(sessionData));
            return newSessionId;
        }

        // Function to update session data
        function updateSession(slideIndex) {
            if (sessionId) {
                const sessionData = {
                    active: true,
                    currentSlide: slideIndex,
                    lastUpdated: new Date().getTime()
                };
                localStorage.setItem('temple-session-' + sessionId, JSON.stringify(sessionData));
            }
        }

        // Function to get session data
        function getSessionData(sid) {
            const data = localStorage.getItem('temple-session-' + sid);
            return data ? JSON.parse(data) : null;
        }

        // Function to end a session
        function endSession() {
            if (sessionId) {
                localStorage.removeItem('temple-session-' + sessionId);
            }
        }

        // Function to show a temple
        function showTemple(index) {
            const temple = temples[index];
            const templeHTML = `
                <div class="temple-display">
                    <img src="${temple.image}" alt="${temple.name}" class="temple-image">
                    <div class="temple-name">${temple.name}</div>
                    <div class="location">${temple.location}</div>
                    <div class="description">${temple.description}</div>
                    <div class="key-facts">
                        <h3>Key Facts</h3>
                        <ul>
                            ${temple.keyFacts.map(fact => `<li>${fact}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            `;
            return templeHTML;
        }

        // Function to show the presenter interface
        function showPresenterInterface() {
            if (!sessionId) {
                sessionId = createSession();
            }

            const baseUrl = window.location.href.split('?')[0];
            const viewerUrl = `${baseUrl}?session=${sessionId}&direct=true`;

            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <div class="presenter-bar">
                    <h2 style="margin: 0;">Presenter Mode</h2>
                    <div>Session ID: <strong>${sessionId}</strong></div>
                </div>

                <div class="share-section">
                    <h3>Share With Your Audience</h3>
                    <p><strong>Direct Link:</strong></p>
                    <input type="text" id="share-url" value="${viewerUrl}" readonly>
                    <button id="copy-url-btn" class="btn">Copy Link</button>

                    <p><strong>Session ID:</strong></p>
                    <input type="text" id="share-id" value="${sessionId}" readonly>
                    <button id="copy-id-btn" class="btn">Copy ID</button>

                    <div id="qrcode" style="margin: 15px auto; text-align: center;"></div>
                </div>

                ${showTemple(currentTempleIndex)}

                <div class="controls">
                    <button id="prev-btn" class="btn" ${currentTempleIndex === 0 ? 'disabled' : ''}>⬅️ Previous</button>
                    <div style="align-self: center;">
                        <span id="temple-counter">${currentTempleIndex + 1}</span> of ${temples.length}
                    </div>
                    <button id="next-btn" class="btn" ${currentTempleIndex === temples.length - 1 ? 'disabled' : ''}>Next ➡️</button>
                </div>

                <button id="end-session-btn" class="btn" style="background-color: #d9534f; width: 100%; margin-top: 20px;">End Session</button>
            `;

            // Generate QR code
            new QRCode(document.getElementById("qrcode"), {
                text: viewerUrl,
                width: 128,
                height: 128
            });

            // Add event listeners
            document.getElementById('copy-url-btn').addEventListener('click', function() {
                const input = document.getElementById('share-url');
                input.select();
                document.execCommand('copy');
                this.textContent = 'Copied!';
                setTimeout(() => {
                    this.textContent = 'Copy Link';
                }, 2000);
            });

            document.getElementById('copy-id-btn').addEventListener('click', function() {
                const input = document.getElementById('share-id');
                input.select();
                document.execCommand('copy');
                this.textContent = 'Copied!';
                setTimeout(() => {
                    this.textContent = 'Copy ID';
                }, 2000);
            });

            document.getElementById('prev-btn').addEventListener('click', function() {
                if (currentTempleIndex > 0) {
                    currentTempleIndex--;
                    navigateToTemple(currentTempleIndex);
                }
            });

            document.getElementById('next-btn').addEventListener('click', function() {
                if (currentTempleIndex < temples.length - 1) {
                    currentTempleIndex++;
                    navigateToTemple(currentTempleIndex);
                }
            });

            document.getElementById('end-session-btn').addEventListener('click', function() {
                if (confirm('Are you sure you want to end this presentation session?')) {
                    endSession();
                    window.location.href = baseUrl;
                }
            });
        }

        // Function to show the viewer interface
        function showViewerInterface() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                ${showTemple(currentTempleIndex)}
                <div style="text-align: center; margin-top: 20px;">
                    Temple <span id="temple-counter">${currentTempleIndex + 1}</span> of ${temples.length}
                </div>
            `;
        }

        // Function to navigate to a specific temple
        function navigateToTemple(index) {
            currentTempleIndex = index;
            
            if (isPresenterMode) {
                // Update for presenter
                const templeDisplay = document.querySelector('.temple-display');
                templeDisplay.outerHTML = showTemple(index);
                
                document.getElementById('temple-counter').textContent = index + 1;
                
                document.getElementById('prev-btn').disabled = index === 0;
                document.getElementById('next-btn').disabled = index === temples.length - 1;
                
                // Update session data
                updateSession(index);
            } else {
                // Update for viewer
                showViewerInterface();
            }
        }

        // Function to show the waiting screen
        function showWaitingScreen() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <div class="waiting-screen">
                    <h2>Connecting to presentation...</h2>
                    <p class="animated-dots">Waiting for presenter</p>
                    <p>Session ID: ${sessionId}</p>
                </div>
            `;
        }

        // Function to show the login screen
        function showLoginScreen() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <div class="login-container">
                    <button id="presenter-btn" class="btn" style="margin-bottom: 30px; width: 100%;">Start as Presenter</button>
                    
                    <h3>Join Existing Presentation</h3>
                    <div class="form-group">
                        <input type="text" id="session-input" placeholder="Enter session ID">
                        <button id="join-btn" class="btn" style="width: 100%;">Join Session</button>
                    </div>
                </div>
            `;

            // Add event listeners
            document.getElementById('presenter-btn').addEventListener('click', function() {
                const password = prompt("Enter presenter password:");
                if (password === PRESENTER_PASSWORD) {
                    isPresenterMode = true;
                    sessionId = createSession();
                    window.location.href = `${window.location.href.split('?')[0]}?presenter=${password}&session=${sessionId}`;
                } else {
                    alert("Incorrect password");
                }
            });

            document.getElementById('join-btn').addEventListener('click', function() {
                const sid = document.getElementById('session-input').value.trim();
                if (sid) {
                    window.location.href = `${window.location.href.split('?')[0]}?session=${sid}&direct=true`;
                } else {
                    alert("Please enter a session ID");
                }
            });

            document.getElementById('session-input').addEventListener('keyup', function(e) {
                if (e.key === 'Enter') {
                    document.getElementById('join-btn').click();
                }
            });
        }

        // Function to start polling for updates as a viewer
        function startPolling() {
            const pollInterval = setInterval(() => {
                const sessionData = getSessionData(sessionId);
                
                if (!sessionData) {
                    // Session doesn't exist yet
                    return;
                }
                
                if (!sessionData.active) {
                    // Session ended
                    clearInterval(pollInterval);
                    const contentArea = document.getElementById('content-area');
                    contentArea.innerHTML = `
                        <div class="waiting-screen">
                            <h2>Session Ended</h2>
                            <p>The presenter has ended this presentation session.</p>
                            <button id="home-btn" class="btn">Return to Home</button>
                        </div>
                    `;
                    document.getElementById('home-btn').addEventListener('click', function() {
                        window.location.href = window.location.href.split('?')[0];
                    });
                    return;
                }
                
                // Update current slide if changed
                if (sessionData.currentSlide !== currentTempleIndex) {
                    currentTempleIndex = sessionData.currentSlide;
                    showViewerInterface();
                }
            }, 1000);
        }

        // Initialize the application
        function initApp() {
            const urlParams = new URLSearchParams(window.location.search);
            const sessionParam = urlParams.get('session');
            const presenterParam = urlParams.get('presenter');

            if (presenterParam === PRESENTER_PASSWORD && sessionParam) {
                // Presenter mode with existing session
                isPresenterMode = true;
                sessionId = sessionParam;
                showPresenterInterface();
                return;
            }

            if (sessionParam) {
                // Viewer mode
                sessionId = sessionParam;
                const sessionData = getSessionData(sessionId);
                
                if (sessionData && sessionData.active) {
                    // Session exists and is active
                    currentTempleIndex = sessionData.currentSlide;
                    showViewerInterface();
                    startPolling();
                } else {
                    // Session doesn't exist yet or is not active
                    showWaitingScreen();
                    startPolling();
                }
                return;
            }

            // Show login screen by default
            showLoginScreen();
        }

        // Start the application
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
